{"{\"assumptions\":{},\"sourceRoot\":\"/Users/gimjunhyeong/singmeta/singmeta/Phaser3/src/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/gimjunhyeong/singmeta/singmeta/Phaser3\",\"filename\":\"/Users/gimjunhyeong/singmeta/singmeta/Phaser3/src/server.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/gimjunhyeong/singmeta/singmeta/Phaser3\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"proposal-class-static-block\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ClassBody\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-private-property-in-object\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"BinaryExpression\":{\"enter\":[null]}},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"proposal-class-properties\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"proposal-private-methods\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"proposal-numeric-separator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"NumericLiteral\":{\"enter\":[null]},\"BigIntLiteral\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-logical-assignment-operators\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"AssignmentExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":true,\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-json-strings\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"DirectiveLiteral\":{\"enter\":[null]},\"StringLiteral\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-optional-catch-binding\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"CatchClause\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-parameters\",\"visitor\":{\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-async-generator-functions\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-object-rest-spread\",\"visitor\":{\"VariableDeclarator\":{\"enter\":[null]},\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dotall-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-unicode-property-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-named-capturing-groups-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-async-to-generator\",\"visitor\":{\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-exponentiation-operator\",\"visitor\":{\"AssignmentExpression\":{\"enter\":[null]},\"BinaryExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-template-literals\",\"visitor\":{\"TaggedTemplateExpression\":{\"enter\":[null]},\"TemplateLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-literals\",\"visitor\":{\"NumericLiteral\":{\"enter\":[null]},\"StringLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-function-name\",\"visitor\":{\"FunctionExpression\":{\"exit\":[null]},\"ObjectProperty\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-arrow-functions\",\"visitor\":{\"ArrowFunctionExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-block-scoped-functions\",\"visitor\":{\"BlockStatement\":{\"enter\":[null]},\"SwitchCase\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-classes\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]},\"ClassExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-object-super\",\"visitor\":{\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-shorthand-properties\",\"visitor\":{\"ObjectMethod\":{\"enter\":[null]},\"ObjectProperty\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-duplicate-keys\",\"visitor\":{\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-computed-properties\",\"visitor\":{\"ObjectExpression\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-for-of\",\"visitor\":{\"ForOfStatement\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-sticky-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-unicode-escapes\",\"visitor\":{\"Identifier\":{\"enter\":[null]},\"TemplateElement\":{\"enter\":[null]},\"_exploded\":true,\"StringLiteral\":{\"enter\":[null]},\"DirectiveLiteral\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-unicode-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-spread\",\"visitor\":{\"ArrayExpression\":{\"enter\":[null]},\"CallExpression\":{\"enter\":[null]},\"NewExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-destructuring\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"VariableDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-block-scoping\",\"visitor\":{\"VariableDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"_exploded\":true,\"BlockStatement\":{\"enter\":[null]},\"SwitchStatement\":{\"enter\":[null]},\"Program\":{\"enter\":[null]},\"_verified\":true,\"DoWhileStatement\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForStatement\":{\"enter\":[null]},\"WhileStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-typeof-symbol\",\"visitor\":{\"UnaryExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"BlockStatement\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"DoWhileStatement\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForStatement\":{\"enter\":[null]},\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"Program\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"SwitchStatement\":{\"enter\":[null]},\"WhileStatement\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"StaticBlock\":{\"enter\":[null]},\"TSModuleBlock\":{\"enter\":[null]},\"AssignmentPattern\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectPattern\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-new-target\",\"visitor\":{\"MetaProperty\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"regenerator-transform\",\"visitor\":{\"_exploded\":true,\"_verified\":true,\"ObjectMethod\":{\"enter\":[null],\"exit\":[null]},\"ClassMethod\":{\"enter\":[null],\"exit\":[null]},\"ClassPrivateMethod\":{\"enter\":[null],\"exit\":[null]},\"FunctionDeclaration\":{\"exit\":[null]},\"FunctionExpression\":{\"exit\":[null]},\"ArrowFunctionExpression\":{\"exit\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-dynamic-import\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.7:development":{"value":{"code":"function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\n\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\n\nimport http from \"http\"; //import WebSocket from \"ws\";\n\nimport express from \"express\";\nimport { Socket } from \"dgram\";\nimport { Server } from \"socket.io\";\nimport path from \"path\";\n\nvar __dirname = path.resolve();\n\nvar app = express();\nconsole.log(\"hello\");\napp.set(\"view engine\", \"pug\"); //app.set(\"view engine\", \"ejs\");\n\napp.set(\"views\", __dirname + \"/src/views\");\nconsole.log(__dirname + \"/src/views\");\napp.use(\"/public\", express.static(__dirname + \"/src/public\"));\napp.get(\"/\", function (req, res) {\n  return res.render(\"main\");\n});\napp.get(\"/*\", function (req, res) {\n  return res.redirect(\"/\");\n});\n\nvar handleListen = function handleListen() {\n  return console.log(\"listening on http:localhost:3002!\");\n}; //app.listen(3000, handleListen);\n\n\nvar httpServer = http.createServer(app);\nvar wsServer = new Server(httpServer);\n\nfunction publicRooms() {\n  var _wsServer$sockets$ada = wsServer.sockets.adapter,\n      sids = _wsServer$sockets$ada.sids,\n      rooms = _wsServer$sockets$ada.rooms;\n  var publicRooms = [];\n  rooms.forEach(function (_, key) {\n    if (sids.get(key) === undefined) {\n      publicRooms.push(key);\n    }\n  });\n  return publicRooms;\n}\n\nvar users = [];\nwsServer.on(\"connection\", function (socket) {\n  socket[\"nickname\"] = \"anon\"; //console.log(socket);\n\n  socket.onAny(function (event) {\n    console.log(\"Socket Event:\".concat(event));\n  });\n  socket.on(\"enter_room\", /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(roomName, done) {\n      return regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return socket.join(roomName);\n\n            case 2:\n              _context.next = 4;\n              return done();\n\n            case 4:\n              _context.next = 6;\n              return socket.to(roomName).emit(\"welcome\", socket[\"nickname\"]);\n\n            case 6:\n              users.push(socket[\"nickname\"]);\n              console.log(users);\n              socket.to(roomName).emit(\"users\", users);\n\n            case 9:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function (_x, _x2) {\n      return _ref.apply(this, arguments);\n    };\n  }());\n  socket.on(\"disconnecting\", function () {\n    users.pop();\n    console.log(users);\n    socket.rooms.forEach(function (room) {\n      socket.to(room).emit(\"bye\", socket.nickname);\n      socket.to(room).emit(\"users\", users);\n    });\n  });\n  socket.on(\"new_message\", function (msg, room, done) {\n    socket.to(room).emit(\"new_message\", \"\".concat(socket.nickname, \": \").concat(msg));\n    done();\n  });\n  socket.on(\"nickname\", function (nickname) {\n    socket[\"nickname\"] = nickname;\n  }); //--------------------------------------------------\n\n  socket.on(\"offer\", function (offer, roomName) {\n    socket.to(roomName).emit(\"offer\", offer);\n  });\n  socket.on(\"answer\", function (answer, roomName) {\n    socket.to(roomName).emit(\"answer\", answer);\n  });\n  socket.on(\"ice\", function (ice, roomName) {\n    socket.to(roomName).emit(\"ice\", ice);\n  });\n});\n/*\nconst sockets = [];\n\nwss.on(\"connection\", (bsocket) => {\n  sockets.push(bsocket);\n  bsocket[\"nickname\"] = \"Anon\";\n  console.log(\"Connected to Browser \");\n  bsocket.on(\"close\", () => {\n    console.log(\"Disconnected from the Browser\");\n  });\n  bsocket.on(\"message\", (msg) => {\n    const message = JSON.parse(msg);\n    console.log(message);\n\n    switch (message.type) {\n      case \"new_message\": {\n        sockets.forEach((aSocket) =>\n          aSocket.send(`${bsocket.nickname}: ${message.payload}`)\n        );\n        break;\n      }\n\n      case \"nickname\": {\n        console.log(message.type);\n        console.log(\"nickname \" + message.payload);\n        bsocket[\"nickname\"] = message.payload;\n        break;\n      }\n    }\n  });\n});\n*/\n\nhttpServer.listen(3002, handleListen);\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNlcnZlci5qcyJdLCJuYW1lcyI6WyJodHRwIiwiZXhwcmVzcyIsIlNvY2tldCIsIlNlcnZlciIsInBhdGgiLCJfX2Rpcm5hbWUiLCJyZXNvbHZlIiwiYXBwIiwiY29uc29sZSIsImxvZyIsInNldCIsInVzZSIsInN0YXRpYyIsImdldCIsInJlcSIsInJlcyIsInJlbmRlciIsInJlZGlyZWN0IiwiaGFuZGxlTGlzdGVuIiwiaHR0cFNlcnZlciIsImNyZWF0ZVNlcnZlciIsIndzU2VydmVyIiwicHVibGljUm9vbXMiLCJzb2NrZXRzIiwiYWRhcHRlciIsInNpZHMiLCJyb29tcyIsImZvckVhY2giLCJfIiwia2V5IiwidW5kZWZpbmVkIiwicHVzaCIsInVzZXJzIiwib24iLCJzb2NrZXQiLCJvbkFueSIsImV2ZW50Iiwicm9vbU5hbWUiLCJkb25lIiwiam9pbiIsInRvIiwiZW1pdCIsInBvcCIsInJvb20iLCJuaWNrbmFtZSIsIm1zZyIsIm9mZmVyIiwiYW5zd2VyIiwiaWNlIiwibGlzdGVuIl0sIm1hcHBpbmdzIjoiOzs7O0FBQUEsT0FBT0EsSUFBUCxNQUFpQixNQUFqQixDLENBQ0E7O0FBQ0EsT0FBT0MsT0FBUCxNQUFvQixTQUFwQjtBQUNBLFNBQVNDLE1BQVQsUUFBdUIsT0FBdkI7QUFDQSxTQUFTQyxNQUFULFFBQXVCLFdBQXZCO0FBQ0EsT0FBT0MsSUFBUCxNQUFpQixNQUFqQjs7QUFDQSxJQUFNQyxTQUFTLEdBQUdELElBQUksQ0FBQ0UsT0FBTCxFQUFsQjs7QUFFQSxJQUFNQyxHQUFHLEdBQUdOLE9BQU8sRUFBbkI7QUFFQU8sT0FBTyxDQUFDQyxHQUFSLENBQVksT0FBWjtBQUNBRixHQUFHLENBQUNHLEdBQUosQ0FBUSxhQUFSLEVBQXVCLEtBQXZCLEUsQ0FDQTs7QUFFQUgsR0FBRyxDQUFDRyxHQUFKLENBQVEsT0FBUixFQUFpQkwsU0FBUyxHQUFHLFlBQTdCO0FBRUFHLE9BQU8sQ0FBQ0MsR0FBUixDQUFZSixTQUFTLEdBQUcsWUFBeEI7QUFF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RUFBaUIsVUFBQ2UsR0FBRCxFQUFNWCxRQUFOLEVBQW1CO0FBQ2xDSCxJQUFBQSxNQUFNLENBQUNNLEVBQVAsQ0FBVUgsUUFBVixFQUFvQkksSUFBcEIsQ0FBeUIsS0FBekIsRUFBZ0NPLEdBQWhDO0FBQ0QsR0FGRDtBQUdELENBeENEO0FBMENBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBQ0E3QixVQUFVLENBQUM4QixNQUFYLENBQWtCLElBQWxCLEVBQXdCL0IsWUFBeEIiLCJzb3VyY2VSb290IjoiL1VzZXJzL2dpbWp1bmh5ZW9uZy9zaW5nbWV0YS9zaW5nbWV0YS9QaGFzZXIzL3NyYy8iLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgaHR0cCBmcm9tIFwiaHR0cFwiO1xuLy9pbXBvcnQgV2ViU29ja2V0IGZyb20gXCJ3c1wiO1xuaW1wb3J0IGV4cHJlc3MgZnJvbSBcImV4cHJlc3NcIjtcbmltcG9ydCB7IFNvY2tldCB9IGZyb20gXCJkZ3JhbVwiO1xuaW1wb3J0IHsgU2VydmVyIH0gZnJvbSBcInNvY2tldC5pb1wiO1xuaW1wb3J0IHBhdGggZnJvbSBcInBhdGhcIjtcbmNvbnN0IF9fZGlybmFtZSA9IHBhdGgucmVzb2x2ZSgpO1xuXG5jb25zdCBhcHAgPSBleHByZXNzKCk7XG5cbmNvbnNvbGUubG9nKFwiaGVsbG9cIik7XG5hcHAuc2V0KFwidmlldyBlbmdpbmVcIiwgXCJwdWdcIik7XG4vL2FwcC5zZXQoXCJ2aWV3IGVuZ2luZVwiLCBcImVqc1wiKTtcblxuYXBwLnNldChcInZpZXdzXCIsIF9fZGlybmFtZSArIFwiL3NyYy92aWV3c1wiKTtcblxuY29uc29sZS5sb2coX19kaXJuYW1lICsgXCIvc3JjL3ZpZXdzXCIpO1xuXG5hcHAudXNlKFwiL3B1YmxpY1wiLCBleHByZXNzLnN0YXRpYyhfX2Rpcm5hbWUgKyBcIi9zcmMvcHVibGljXCIpKTtcblxuYXBwLmdldChcIi9cIiwgKHJlcSwgcmVzKSA9PiByZXMucmVuZGVyKFwibWFpblwiKSk7XG5hcHAuZ2V0KFwiLypcIiwgKHJlcSwgcmVzKSA9PiByZXMucmVkaXJlY3QoXCIvXCIpKTtcblxuY29uc3QgaGFuZGxlTGlzdGVuID0gKCkgPT4gY29uc29sZS5sb2coXCJsaXN0ZW5pbmcgb24gaHR0cDpsb2NhbGhvc3Q6MzAwMiFcIik7XG5cbi8vYXBwLmxpc3RlbigzMDAwLCBoYW5kbGVMaXN0ZW4pO1xuXG5jb25zdCBodHRwU2VydmVyID0gaHR0cC5jcmVhdGVTZXJ2ZXIoYXBwKTtcbmNvbnN0IHdzU2VydmVyID0gbmV3IFNlcnZlcihodHRwU2VydmVyKTtcblxuZnVuY3Rpb24gcHVibGljUm9vbXMoKSB7XG4gIGNvbnN0IHtcbiAgICBzb2NrZXRzOiB7XG4gICAgICBhZGFwdGVyOiB7IHNpZHMsIHJvb21zIH0sXG4gICAgfSxcbiAgfSA9IHdzU2VydmVyO1xuXG4gIGNvbnN0IHB1YmxpY1Jvb21zID0gW107XG4gIHJvb21zLmZvckVhY2goKF8sIGtleSkgPT4ge1xuICAgIGlmIChzaWRzLmdldChrZXkpID09PSB1bmRlZmluZWQpIHtcbiAgICAgIHB1YmxpY1Jvb21zLnB1c2goa2V5KTtcbiAgICB9XG4gIH0pO1xuICByZXR1cm4gcHVibGljUm9vbXM7XG59XG5cbnZhciB1c2VycyA9IFtdO1xud3NTZXJ2ZXIub24oXCJjb25uZWN0aW9uXCIsIChzb2NrZXQpID0+IHtcbiAgc29ja2V0W1wibmlja25hbWVcIl0gPSBcImFub25cIjtcbiAgLy9jb25zb2xlLmxvZyhzb2NrZXQpO1xuICBzb2NrZXQub25BbnkoKGV2ZW50KSA9PiB7XG4gICAgY29uc29sZS5sb2coYFNvY2tldCBFdmVudDoke2V2ZW50fWApO1xuICB9KTtcbiAgc29ja2V0Lm9uKFwiZW50ZXJfcm9vbVwiLCBhc3luYyAocm9vbU5hbWUsIGRvbmUpID0+IHtcbiAgICBhd2FpdCBzb2NrZXQuam9pbihyb29tTmFtZSk7XG4gICAgYXdhaXQgZG9uZSgpO1xuICAgIGF3YWl0IHNvY2tldC50byhyb29tTmFtZSkuZW1pdChcIndlbGNvbWVcIiwgc29ja2V0W1wibmlja25hbWVcIl0pO1xuICAgIHVzZXJzLnB1c2goc29ja2V0W1wibmlja25hbWVcIl0pO1xuICAgIGNvbnNvbGUubG9nKHVzZXJzKTtcbiAgICBzb2NrZXQudG8ocm9vbU5hbWUpLmVtaXQoXCJ1c2Vyc1wiLCB1c2Vycyk7XG4gIH0pO1xuICBzb2NrZXQub24oXCJkaXNjb25uZWN0aW5nXCIsICgpID0+IHtcbiAgICB1c2Vycy5wb3AoKTtcbiAgICBjb25zb2xlLmxvZyh1c2Vycyk7XG4gICAgc29ja2V0LnJvb21zLmZvckVhY2goKHJvb20pID0+IHtcbiAgICAgIHNvY2tldC50byhyb29tKS5lbWl0KFwiYnllXCIsIHNvY2tldC5uaWNrbmFtZSk7XG4gICAgICBzb2NrZXQudG8ocm9vbSkuZW1pdChcInVzZXJzXCIsIHVzZXJzKTtcbiAgICB9KTtcbiAgfSk7XG4gIHNvY2tldC5vbihcIm5ld19tZXNzYWdlXCIsIChtc2csIHJvb20sIGRvbmUpID0+IHtcbiAgICBzb2NrZXQudG8ocm9vbSkuZW1pdChcIm5ld19tZXNzYWdlXCIsIGAke3NvY2tldC5uaWNrbmFtZX06ICR7bXNnfWApO1xuICAgIGRvbmUoKTtcbiAgfSk7XG4gIHNvY2tldC5vbihcIm5pY2tuYW1lXCIsIChuaWNrbmFtZSkgPT4ge1xuICAgIHNvY2tldFtcIm5pY2tuYW1lXCJdID0gbmlja25hbWU7XG4gIH0pO1xuXG4gIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgc29ja2V0Lm9uKFwib2ZmZXJcIiwgKG9mZmVyLCByb29tTmFtZSkgPT4ge1xuICAgIHNvY2tldC50byhyb29tTmFtZSkuZW1pdChcIm9mZmVyXCIsIG9mZmVyKTtcbiAgfSk7XG4gIHNvY2tldC5vbihcImFuc3dlclwiLCAoYW5zd2VyLCByb29tTmFtZSkgPT4ge1xuICAgIHNvY2tldC50byhyb29tTmFtZSkuZW1pdChcImFuc3dlclwiLCBhbnN3ZXIpO1xuICB9KTtcbiAgc29ja2V0Lm9uKFwiaWNlXCIsIChpY2UsIHJvb21OYW1lKSA9PiB7XG4gICAgc29ja2V0LnRvKHJvb21OYW1lKS5lbWl0KFwiaWNlXCIsIGljZSk7XG4gIH0pO1xufSk7XG5cbi8qXG5jb25zdCBzb2NrZXRzID0gW107XG5cbndzcy5vbihcImNvbm5lY3Rpb25cIiwgKGJzb2NrZXQpID0+IHtcbiAgc29ja2V0cy5wdXNoKGJzb2NrZXQpO1xuICBic29ja2V0W1wibmlja25hbWVcIl0gPSBcIkFub25cIjtcbiAgY29uc29sZS5sb2coXCJDb25uZWN0ZWQgdG8gQnJvd3NlciBcIik7XG4gIGJzb2NrZXQub24oXCJjbG9zZVwiLCAoKSA9PiB7XG4gICAgY29uc29sZS5sb2coXCJEaXNjb25uZWN0ZWQgZnJvbSB0aGUgQnJvd3NlclwiKTtcbiAgfSk7XG4gIGJzb2NrZXQub24oXCJtZXNzYWdlXCIsIChtc2cpID0+IHtcbiAgICBjb25zdCBtZXNzYWdlID0gSlNPTi5wYXJzZShtc2cpO1xuICAgIGNvbnNvbGUubG9nKG1lc3NhZ2UpO1xuXG4gICAgc3dpdGNoIChtZXNzYWdlLnR5cGUpIHtcbiAgICAgIGNhc2UgXCJuZXdfbWVzc2FnZVwiOiB7XG4gICAgICAgIHNvY2tldHMuZm9yRWFjaCgoYVNvY2tldCkgPT5cbiAgICAgICAgICBhU29ja2V0LnNlbmQoYCR7YnNvY2tldC5uaWNrbmFtZX06ICR7bWVzc2FnZS5wYXlsb2FkfWApXG4gICAgICAgICk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuXG4gICAgICBjYXNlIFwibmlja25hbWVcIjoge1xuICAgICAgICBjb25zb2xlLmxvZyhtZXNzYWdlLnR5cGUpO1xuICAgICAgICBjb25zb2xlLmxvZyhcIm5pY2tuYW1lIFwiICsgbWVzc2FnZS5wYXlsb2FkKTtcbiAgICAgICAgYnNvY2tldFtcIm5pY2tuYW1lXCJdID0gbWVzc2FnZS5wYXlsb2FkO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9XG4gIH0pO1xufSk7XG4qL1xuaHR0cFNlcnZlci5saXN0ZW4oMzAwMiwgaGFuZGxlTGlzdGVuKTtcbiJdfQ==","map":{"version":3,"sources":["server.js"],"names":["http","express","Socket","Server","path","__dirname","resolve","app","console","log","set","use","static","get","req","res","render","redirect","handleListen","httpServer","createServer","wsServer","publicRooms","sockets","adapter","sids","rooms","forEach","_","key","undefined","push","users","on","socket","onAny","event","roomName","done","join","to","emit","pop","room","nickname","msg","offer","answer","ice","listen"],"mappings":"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","sourceRoot":"/Users/gimjunhyeong/singmeta/singmeta/Phaser3/src/","sourcesContent":["import http from \"http\";\n//import WebSocket from \"ws\";\nimport express from \"express\";\nimport { Socket } from \"dgram\";\nimport { Server } from \"socket.io\";\nimport path from \"path\";\nconst __dirname = path.resolve();\n\nconst app = express();\n\nconsole.log(\"hello\");\napp.set(\"view engine\", \"pug\");\n//app.set(\"view engine\", \"ejs\");\n\napp.set(\"views\", __dirname + \"/src/views\");\n\nconsole.log(__dirname + \"/src/views\");\n\napp.use(\"/public\", express.static(__dirname + \"/src/public\"));\n\napp.get(\"/\", (req, res) => res.render(\"main\"));\napp.get(\"/*\", (req, res) => res.redirect(\"/\"));\n\nconst handleListen = () => console.log(\"listening on http:localhost:3002!\");\n\n//app.listen(3000, handleListen);\n\nconst httpServer = http.createServer(app);\nconst wsServer = new Server(httpServer);\n\nfunction publicRooms() {\n  const {\n    sockets: {\n      adapter: { sids, rooms },\n    },\n  } = wsServer;\n\n  const publicRooms = [];\n  rooms.forEach((_, key) => {\n    if (sids.get(key) === undefined) {\n      publicRooms.push(key);\n    }\n  });\n  return publicRooms;\n}\n\nvar users = [];\nwsServer.on(\"connection\", (socket) => {\n  socket[\"nickname\"] = \"anon\";\n  //console.log(socket);\n  socket.onAny((event) => {\n    console.log(`Socket Event:${event}`);\n  });\n  socket.on(\"enter_room\", async (roomName, done) => {\n    await socket.join(roomName);\n    await done();\n    await socket.to(roomName).emit(\"welcome\", socket[\"nickname\"]);\n    users.push(socket[\"nickname\"]);\n    console.log(users);\n    socket.to(roomName).emit(\"users\", users);\n  });\n  socket.on(\"disconnecting\", () => {\n    users.pop();\n    console.log(users);\n    socket.rooms.forEach((room) => {\n      socket.to(room).emit(\"bye\", socket.nickname);\n      socket.to(room).emit(\"users\", users);\n    });\n  });\n  socket.on(\"new_message\", (msg, room, done) => {\n    socket.to(room).emit(\"new_message\", `${socket.nickname}: ${msg}`);\n    done();\n  });\n  socket.on(\"nickname\", (nickname) => {\n    socket[\"nickname\"] = nickname;\n  });\n\n  //--------------------------------------------------\n  socket.on(\"offer\", (offer, roomName) => {\n    socket.to(roomName).emit(\"offer\", offer);\n  });\n  socket.on(\"answer\", (answer, roomName) => {\n    socket.to(roomName).emit(\"answer\", answer);\n  });\n  socket.on(\"ice\", (ice, roomName) => {\n    socket.to(roomName).emit(\"ice\", ice);\n  });\n});\n\n/*\nconst sockets = [];\n\nwss.on(\"connection\", (bsocket) => {\n  sockets.push(bsocket);\n  bsocket[\"nickname\"] = \"Anon\";\n  console.log(\"Connected to Browser \");\n  bsocket.on(\"close\", () => {\n    console.log(\"Disconnected from the Browser\");\n  });\n  bsocket.on(\"message\", (msg) => {\n    const message = JSON.parse(msg);\n    console.log(message);\n\n    switch (message.type) {\n      case \"new_message\": {\n        sockets.forEach((aSocket) =>\n          aSocket.send(`${bsocket.nickname}: ${message.payload}`)\n        );\n        break;\n      }\n\n      case \"nickname\": {\n        console.log(message.type);\n        console.log(\"nickname \" + message.payload);\n        bsocket[\"nickname\"] = message.payload;\n        break;\n      }\n    }\n  });\n});\n*/\nhttpServer.listen(3002, handleListen);\n"]}},"mtime":1647871762373}}